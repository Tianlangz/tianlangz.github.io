---
author: Hugo Authors
title: 习题
date: 2022-04-22
description:  数据库
series:
  - 数据库

---

每一章的习题都在这里。

<!--more-->

### 1
  编写语句从Customers表中检索所有的ID(cust_id)。
  ```sql
  SELECT cust_id
  FROM Customers;
  ```

### 2
  OrderItems 表包含了所有已订购的产品(有些已经被订购多次)。编写SQL 语句，检索并列出已订购产品（prod_id）的清单（不用列每个订单，只列出不同产品的清单）。提示：最终应该显示 7 行。
  ```sql
   SELECT DISTINCT Prod_id
   FROM OrderItems;
  ```

### 3
  编写 SQL语句，检索 Customers 表中所有的列，再编写另外的 SELECT语句，仅检索顾客的 ID。使用注释，注释掉一条 SELECT 语句，以便运行另一条 SELECT 语句。（当然，要测试这两个语句。）
  ```sql
   /*SELECT * 
   FROM Customers;*/
   SELECT cust_id
   FROM Customers;
  ```

### 4
  编写 SQL 语句，从 Customers 中检索所有的顾客名称（cust_names），并按从 Z 到 A 的顺序显示结果。
  ```sql
   SELECT cust_names
   FROM Customers
   ORDER BY cust_name DESC;
  ```

### 5
  编写 SQL 语句，从 Orders 表中检索顾客 ID（cust_id）和订单号（order_num），并先按顾客 ID 对结果进行排序，再按订单日期倒序排列。
  ```sql
   SELECT cust_id, order_num
   FROM Orders
   ORDER BY cust_id, order_date DESC;
  ```

### 6
  显然，我们的虚拟商店更喜欢出售比较贵的物品，而且这类物品有很多。编写 SQL 语句，显示 OrderItems 表中的数量和价格（item_price），并按数量由多到少、价格由高到低排序。
  ```sql
   SELECT quantity, item_price
   FROM OrderItems
   ORDER BY quantity DESC , item_price DESC;
  ```

### 7
  下面的 SQL 语句有问题吗？（尝试在不运行的情况下指出。）
  ```sql
   SELECT vend_name,
   FROM Vendors
   ORDER vend_name DESC;
  ```
  少了一个`BY`。

### 8
  编写 SQL 语句，从 Products 表中检索产品 ID（prod_id）和产品名称（prod_name），只返回价格为 9.49 美元的产品。
  ```sql
   SELECT prod_id, prod_name
   FROM Products
   WHERE prod_price = 9.49;
  ```

### 9
  编写 SQL 语句，从 Products 表中检索产品 ID（prod_id）和产品名称（prod_name），只返回价格为 9 美元或更高的产品。
  ```sql
   SELECT prod_id, prod_name
   FROM Products
   WHERE prod_price >= 9;
  ```

### 10
  编写 SQL 语句，从 OrderItems 表中检索出所有不同订单号（order_num），其中包含 100 个或更多的产品。
  ```sql
   SELECT DISTINCT order_num
   FROM OrderItems
   WHERE quantity >=100;
  ```

### 11
  编写 SQL 语句，返回 Products 表中所有价格在 3 美元到 6 美元之间的产品的名称（prod_name）和价格（prod_price），然后按价格对结果进行排序。
  ```sql
   SELECT prod_name, prod_price
   FROM Products
   WHERE prod_price BETWEEN 3 AND 6
   ORDER BY prod_price;
  ```

### 12
  编写 SQL 语句，从 Vendors 表中检索供应商名称（vend_name），仅返回加利福尼亚州的供应商（这需要按国家[USA]和州[CA]进行过滤，没准其他国家也存在一个加利福尼亚州）。提示：过滤器需要匹配字符串。
  ```sql
   SELECT vend_name
   FROM Vendors
   WHERE vend_country = 'USA' AND vend_state = 'CA';
  ```

### 13
  编写 SQL 语句，查找所有至少订购了总量 100 个的 BR01、BR02 或BR03 的订单。你需要返回 OrderItems 表的订单号（order_num）、产品 ID（prod_id）和数量，并按产品 ID 和数量进行过滤。提示：根据编写过滤器的方式，可能需要特别注意求值顺序。
  ```sql
   SELECT order_num, prod_id
   FROM OrderItems
   WHERE quantity >= 100 AND prod_id = 'BR01' OR prod_id = 'BR02' OR prod_id = 'BR03';
  ```

### 14
  回顾11题，编写 SQL 语句，返回所有价格在 3美元到 6美元之间的产品的名称（prod_name）和价格（prod_price）。使用 AND，然后按价格对结果进行排序。
  ```sql
   SELECT prod_name, prod_price
   FROM Products
   WHERE prod_price = 3 AND prod_price = 6
   ORDER BY prod_price;
  ```

### 15
  下面的 SQL 语句有问题吗？（尝试在不运行的情况下指出。）
  ```sql
   SELECT vend_name
   FROM Vendors
   ORDER BY vend_name
   WHERE vend_country = 'USA' AND vend_state = 'CA';
  ```
  `ORDER BY`子句应该写在最后面。

### 16
  编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中包含 toy 一词的产品。
  ```sql
   SELECT prod_name, prod_desc
   FROM Products
   WHERE prod_desc LIKE '%toy%';
  ```

### 17
  反过来再来一次。编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中未出现 toy 一词的产品。这次，按产品名称对结果进行排序。
  ```sql
   SELECT prod_name, prod_desc
   FROM Products
   WHERE prod_desc NOT LIKE '%toy%';
  ```

### 18
  编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中同时出现 toy 和 carrots 的产品。有好几种方法可以执行此操作，但对于这个挑战题，请使用 AND 和两个 LIKE 比较。
  ```sql
   SELECT prod_name, prod_desc
   FROM Products
   WHERE Products NOT LIKE '%toy%' AND Products NOT LIKE '%carrots%';
  ```

### 19
  编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回在描述中以先后顺序同时出现 toy 和 carrots 的产品。提示：只需要用带有三个 % 符号的 LIKE 即可。
  ```sql
   SELECT prod_name, prod_desc
   FROM Products
   WHERE prod_desc LIKE '%toy%carrots%';
  ```

### 20
  别名的常见用法是在检索出的结果中重命名表的列字段（为了符合特定的报表要求或客户需求）。编写 SQL 语句，从 Vendors 表中检索vend_id、vend_name、vend_address 和 vend_city，将 vend_name 重命名为 vname，将 vend_city 重命名为 vcity，将 vend_address重命名为 vaddress。按供应商名称对结果进行排序（可以使用原始名称或新的名称）。
  ```sql
   SELECT vend_id, vend_name AS vname, vend_city AS vcity, vend_address AS vaddress
   FROM Vendors
   ORDER BY vend_name;
  ```

### 21
  我们的示例商店正在进行打折促销，所有产品均降价 10%。编写 SQL语句，从 Products 表中返回 prod_id、prod_price 和 sale_price。sale_price 是一个包含促销价格的计算字段。提示：可以乘以 0.9，得到原价的 90%（即 10%的折扣）。
  ```sql
   SELECT prod_id, prod_price, prod_price * 0.9 AS sale_price
   FROM Products;
  ```

### 22
  我们的商店已经上线了，正在创建顾客账户。所有用户都需要登录名，默认登录名是其名称和所在城市的组合。编写 SQL 语句，返回顾客 ID（cust_id）、顾客名称（customer_name）和登录名（user_login），其中登录名全部为大写字母，并由顾客联系人的前两个字符（cust_contact）和其所在城市的前三个字符（cust_city）组成。例如，我的登录名是 BEOAK（Ben Forta，居住在 Oak Park）。提示：需要使用函数、拼接和别名。
  ```sql
   SELECT cust_id, customer_name, UPPER(LEFT(cust_contact,2) + LEFT(cust_city,3)) AS user_login
   FROM Customers;
  ```

### 23
  编写 SQL 语句，返回 2020 年 1 月的所有订单的订单号（order_num）和订单日期（order_date），并按订单日期排序。你应该能够根据目前已学的知识来解决此问题，但也可以开卷查阅 DBMS 文档。
  ```sql
   SELECT order_num, order_date
   FROM Orders
   WHERE DATEPART(yy,order_date) = 2020 AND DATEPART (mm,order_date) = 1
   ORDER BY order_date;
  ```

### 24
  编写 SQL 语句，确定已售出产品的总数（使用 OrderItems 中的quantity 列）。
  ```sql
   SELECT sum(quantity)
   FROM OrderItems;
  ```

### 25
  修改刚刚创建的语句，确定已售出产品项（prod_id）BR01 的总数。
  ```sql
   SELECT sum(quantity)
   FROM OrderItems
   WHERE prod_id = 'BR01';
  ```

### 26
  编写 SQL 语句，确定 Products 表中价格不超过 10 美元的最贵产品的价格（prod_price）。将计算所得的字段命名为 max_price。
  ```sql
   SELECT MAX(prod_price) AS max_price
   FROM Products
   WHERE prod_price <= 10;
  ```

### 27
  OrderItems 表包含每个订单的每个产品。编写 SQL 语句，返回每个订单号（order_num）各有多少行数（order_lines），并按 order_lines对结果进行排序。
  ```sql
   SELECT order_num, COUNT(order_num) AS order_lines
   FROM OrderItems
   GROUP BY order_num
   ORDER BY order_lines;
  ```

### 28
  编写 SQL 语句，返回名为 cheapest_item 的字段，该字段包含每个供应商成本最低的产品（使用 Products 表中的 prod_price），然后从最低成本到最高成本对结果进行排序。
  ```sql
   SELECT min(prod_price) AS cheapest_item
   FROM Products
   GROUP BY vend_id
   ORDER BY cheapest_item;
  ```

### 29
  确定最佳顾客非常重要，请编写 SQL 语句，返回至少含 100 项的所有订单的订单号（OrderItems 表中的 order_num）。
  ```sql
   SELECT order_num
   FROM OrderItems
   GROUP BY order_num
   HAVING sum(quantity) >= 100;
  ```

### 30
  确定最佳顾客的另一种方式是看他们花了多少钱。编写 SQL 语句，返回总价至少为 1000 的所有订单的订单号（OrderItems 表中的order_num）。提示：需要计算总和（item_price 乘以 quantity）。按订单号对结果进行排序。
  ```sql
   SELECT order_num, sum(item_price * quantity)
   FROM OrderItems
   GROUP BY order_num
   HAVING sum(item_price * quantity) >= 1000;
  ```

### 31
  下面的 SQL 语句有问题吗？（尝试在不运行的情况下指出。）
  ```sql
   SELECT order_num, COUNT(*) AS items
   FROM OrderItems
   GROUP BY items
   HAVING COUNT(*) >= 3
   ORDER BY items, order_num;
  ```
`GROUP BY` 后面不应该是别名

### 32
  使用子查询，返回购买价格为 10 美元或以上产品的顾客列表。你需要使用 OrderItems 表查找匹配的订单号（order_num），然后使用Order 表检索这些匹配订单的顾客 ID（cust_id）。