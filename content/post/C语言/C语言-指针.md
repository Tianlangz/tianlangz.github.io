---
author: Hugo Authors
title: C语言-指针
date: 2022-05-12
description:  C语言
series:
  - C语言

---
```

```
<!--more-->
# C语言指针到底是什么？
计算机中所有数据都需要放在内存中，不同类型的数据在内存中存放的字节数也各不相同，而我们为了表达清楚各个数据在内存中的位置，为数据在内存中的字节编上了号码。每个字节的号码都是不一样的，根据号码就可以找到你想要的字节。而我们将这种号码称之为`地址(Address)`或者`指针(Pointer)`。就像我们用输入函数时的`&`符号，它是取出我们输入的值放入我们的命名的变量的地址中。

## 一切都是地址
C语言用变量来存储数据，用函数来定义一段可以重复使用的代码，它们最终都要放到内存中才能被CPU调用。

CPU访问内存时需要的是地址，不是变量名或是函数名！变量名和函数名只是地址的一种助记符，当源文件被编译和链接成可执行程序时，他们都会被替换成地址。编译和链接过程的一项重要任务就是找到这些名称所对应的地址。

变量名和函数名是为了给我们提供方便，不用去直面二进制地址。需要注意的是，虽然变量名、函数名、字符串名和数组名在本质上是一样的，它们都是地址的助记符，但在编写程序时，我们认为变量名表示的是数据本身，而函数名，字符串名和数组名表示的是代码块或数据块的首地址。

# 指针
数据在内存中的地址也称为指针，如果一个变量存储了一个数据的指针，那么这个变量就称为指针变量。

在C语言中，允许用一个变量来存放指针，也就是指针变量，而指针变量中的值就是数据的地址，这样的一份数据可以是数组、字符串、函数、也可以是另外的一个普通变量或指针变量。

## 定义指针变量
定义指针变量与定义普通变量非常的类似，不过要在变量名前加星号`*`，格式为：
```c
datatype *name;
```
datatype 表示这个指针变量的数据类型。

它和普通的变量并没有特别大的区别，只是它其中存的不是数值，而是地址，我用一段简单的代码让大家了解一下指针变量和普通变量的区别
```c
//定义普通变量
float a = 99.5, b = 10.6;
char c = '@', d = '#';
//定义指针变量
float *p1 = &a;
char *p2 = &c;
//修改指针变量的值
p1 = &b;
p2 = &d;
```
*号是一个特殊符号，表明一个变量是指针变量，定义p1、p2时必须带上*，而给p1、p2赋值时，因为已经知道它是一个指针变量，就没有多此一举再带上*号了，后边可以像使用普通变量一样来使用指针变量。

而上面的程序变化情况如下图：
![](/images/1IG3J50-1.jpg)

需要强调的是p1、p2的类型分别是`float*`和`char*`,而不是float和char，他们是完全不同的数据类型。

指针变量也可以连续定义：
```c
int *a, *b, *c;
//或者只定义一个
int *a, b, c;
```

## 通过指针变量取得数据
这里的*称为指针运算符，用来取得某个地址上的数据。
```c
#include <stdio.h>
int main(){
    int a = 15;
    int *p = &a;
    printf("%d, %d\n", a, *p);  //两种方式都可以输出a的值
    return 0;
}
```
运行结果：15,15

我们说过类似于这样赋值，是将`a`的地址赋值给了`p`这个指针变量，而`*p`则表示取得这个地址上的数据，也就是变成了取`a`上的数据，也就是说，`a`这个变量名是直接通过地址取得自己的数据。而`*p`,`p`存的是`a`这个变量的内存地址，是`*p`是获取`p`存的地址上的值。

也就是说*p是间接获取数据，而a是直接后取数据，前者比后者的代价要高。

指针除了能读这个地址上的数据还拥有修改的权力。

`*`号在不同的场景下有不同的作用：`*`号可以用在指针变量的定义中，表明这是一个指针变量，以和普通变量区分开；使用指针变量时在前面加上一个`*`表示获取指针指向的数据，或者说指向这个数据的本身。

明白指针变量最主要的是要明白这个指针到底指的是`数据`还是`地址`。

也就是说，定义指针变量时的`*`和使用指针变量时的`*`意义完全不一样，例如：
```c
int *p = &a;
*p=100;
//他还有另一种赋值的写法
int *p;
p = &a;
*p = 100;
```
两段程序表示的是一个意思。但是给指针变量本身赋值时不能加上`*`；

指针变量也可以出现在普通变量能出现的任何表达式中，比如：
```c
int x, y, *px = &x, *py = &y;
y = *px + 5;//表示把x的值加5赋值给y
y = ++*px;//表示将x中的值加一之后赋给y，++*px相当于++(*px)
y = *px++;//相当于y = *(px++)
py = px;//是将一个指针中存的值赋给另一个指针变量
```

### 我们来重申一下`*`和`&`的关系
```c
int a, *pa = &a;
```
那么`*&a`和`&*pa`分别是什么意思嘞？

1. `*&a`可以理解为`*(&a)`,而其中`&a`就是表示变量`a`的地址，那也就是说等价于`pa`，那如果是这样我们把`pa`带入到原来的表达式中，那么原来的表达式就可以表示为`*pa`,也就是说绕来绕去取得还是`a`中的值。

2. `&*pa`可以理解为`&(*pa)`,而其中的`*pa`指向的时`a`中的数据，那么我们就可以把`a`代入回原来的式子中，也就时变成了`&a`也就是表示取`a`中的地址。也就是说`&*pa`等价于`pa`

### 在这里我不得不对*做一个小总结
在我们目前学习的语法中星号`*`主要有三种用途：
 - 表示乘法，这个我就不做过多阐述了
 - 表示一个指针变量，以便普通变量分开
 - 表示获取指针指向的数据，类似于一种间接性的操作


